(()=>{function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function s(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}function o(e,t){return function(n,r){t(n,r,e)}}function i(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(s=2&a[0]?r.return:a[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,a[1])).done)return s;switch(r=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(s=i.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i}function l(e,t,n){if(n||2===arguments.length)for(var r,s=0,o=t.length;s<o;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))}function p(e){return this instanceof p?(this.v=e,this):new p(e)}function h(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,s=n.apply(e,t||[]),o=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){s[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=s[e](t)).value instanceof p?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function d(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=c(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,s){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,s,(t=e[n](t)).done,t.value)}))}}}Object.create;
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var f,v,g,y=f={};function m(){throw new Error("setTimeout has not been defined")}function b(){throw new Error("clearTimeout has not been defined")}function w(e){if(v===setTimeout)return setTimeout(e,0);if((v===m||!v)&&setTimeout)return v=setTimeout,setTimeout(e,0);try{return v(e,0)}catch(t){try{return v.call(null,e,0)}catch(t){return v.call(this,e,0)}}}!function(){try{v="function"==typeof setTimeout?setTimeout:m}catch(e){v=m}try{g="function"==typeof clearTimeout?clearTimeout:b}catch(e){g=b}}();var _,S,E,C,I=[],T=!1,A=-1;function L(){T&&_&&(T=!1,_.length?I=_.concat(I):A=-1,I.length&&O())}function O(){if(!T){var e=w(L);T=!0;for(var t=I.length;t;){for(_=I,I=[];++A<t;)_&&_[A].run();A=-1,t=I.length}_=null,T=!1,function(e){if(g===clearTimeout)return clearTimeout(e);if((g===b||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(e);try{g(e)}catch(t){try{return g.call(null,e)}catch(t){return g.call(this,e)}}}(e)}}function R(e,t){this.fun=e,this.array=t}function k(){}y.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];I.push(new R(e,t)),1!==I.length||T||w(O)},R.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={},y.on=k,y.addListener=k,y.once=k,y.off=k,y.removeListener=k,y.removeAllListeners=k,y.emit=k,y.prependListener=k,y.prependOnceListener=k,y.listeners=function(e){return[]},y.binding=function(e){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function(e){throw new Error("process.chdir is not supported")},y.umask=function(){return 0},function(e){!function(n){var r="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=o(e);function o(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:s=o(r.Reflect,s),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,i={__proto__:[]}instanceof Array,a=!o&&!i,c={create:o?function(){return se(Object.create(null))}:i?function(){return se({__proto__:null})}:function(){return se({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof f&&f.env&&!1,p=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?ne():Set,d=new(l||"function"!=typeof WeakMap?re():WeakMap);function v(e,t,n,r){if(D(n)){if(!$(e))throw new TypeError;if(!q(t))throw new TypeError;return I(e,t)}if(!$(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!D(r)&&!M(r))throw new TypeError;return M(r)&&(r=void 0),T(e,t,n=W(n),r)}function g(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!D(r)&&!Q(r))throw new TypeError;P(e,t,n,r)}return n}function y(e,t,n,r){if(!F(n))throw new TypeError;return D(r)||(r=W(r)),P(e,t,n,r)}function m(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=W(n)),L(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=W(n)),O(e,t,n)}function w(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=W(n)),R(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=W(n)),k(e,t,n)}function S(e,t){if(!F(e))throw new TypeError;return D(t)||(t=W(t)),V(e,t)}function E(e,t){if(!F(e))throw new TypeError;return D(t)||(t=W(t)),x(e,t)}function C(e,t,n){if(!F(t))throw new TypeError;D(n)||(n=W(n));var r=A(t,n,!1);if(D(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var s=d.get(t);return s.delete(n),s.size>0||d.delete(t),!0}function I(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!D(r)&&!M(r)){if(!q(r))throw new TypeError;t=r}}return t}function T(e,t,n,r){for(var s=e.length-1;s>=0;--s){var o=(0,e[s])(t,n,r);if(!D(o)&&!M(o)){if(!F(o))throw new TypeError;r=o}}return r}function A(e,t,n){var r=d.get(e);if(D(r)){if(!n)return;r=new p,d.set(e,r)}var s=r.get(t);if(D(s)){if(!n)return;s=new p,r.set(t,s)}return s}function L(e,t,n){if(O(e,t,n))return!0;var r=ee(t);return!M(r)&&L(e,r,n)}function O(e,t,n){var r=A(t,n,!1);return!D(r)&&H(r.has(e))}function R(e,t,n){if(O(e,t,n))return k(e,t,n);var r=ee(t);return M(r)?void 0:R(e,r,n)}function k(e,t,n){var r=A(t,n,!1);if(!D(r))return r.get(e)}function P(e,t,n,r){A(n,r,!0).set(e,t)}function V(e,t){var n=x(e,t),r=ee(e);if(null===r)return n;var s=V(r,t);if(s.length<=0)return n;if(n.length<=0)return s;for(var o=new h,i=[],a=0,c=n;a<c.length;a++){var u=c[a];o.has(u)||(o.add(u),i.push(u))}for(var l=0,p=s;l<p.length;l++){u=p[l];o.has(u)||(o.add(u),i.push(u))}return i}function x(e,t){var n=[],r=A(e,t,!1);if(D(r))return n;for(var s=Y(r.keys()),o=0;;){var i=Z(s);if(!i)return n.length=o,n;var a=J(i);try{n[o]=a}catch(e){try{X(s)}finally{throw e}}o++}}function N(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function D(e){return void 0===e}function M(e){return null===e}function U(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function G(e,t){switch(N(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",s=K(e,r);if(void 0!==s){var o=s.call(e,n);if(F(o))throw new TypeError;return o}return j(e,"default"===n?"number":n)}function j(e,t){if("string"===t){var n=e.toString;if(z(n))if(!F(s=n.call(e)))return s;if(z(r=e.valueOf))if(!F(s=r.call(e)))return s}else{var r;if(z(r=e.valueOf))if(!F(s=r.call(e)))return s;var s,o=e.toString;if(z(o))if(!F(s=o.call(e)))return s}throw new TypeError}function H(e){return!!e}function B(e){return""+e}function W(e){var t=G(e,3);return U(t)?t:B(t)}function $(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function q(e){return"function"==typeof e}function Q(e){switch(N(e)){case 3:case 4:return!0;default:return!1}}function K(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function Y(e){var t=K(e,s);if(!z(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function J(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var s=r.constructor;return"function"!=typeof s||s===e?t:s}function te(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,s=n+1;s<r;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,i)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function i(e,t){return[e,t]}}function ne(){return function(){function e(){this._map=new p}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}()}function re(){var e=16,n=c.create(),r=s();return function(){function e(){this._key=s()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=s()},e}();function s(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:c.create()})}return e[r]}function i(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):i(new Uint8Array(e),e):i(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var s=t[r];4!==r&&6!==r&&8!==r||(n+="-"),s<16&&(n+="0"),n+=s.toString(16).toLowerCase()}return n}}function se(e){return e.__=void 0,delete e.__,e}e("decorate",v),e("metadata",g),e("defineMetadata",y),e("hasMetadata",m),e("hasOwnMetadata",b),e("getMetadata",w),e("getOwnMetadata",_),e("getMetadataKeys",S),e("getOwnMetadataKeys",E),e("deleteMetadata",C)}(s)}()}(S||(S={})),(C=E||(E={}))[C.Transient=0]="Transient",C[C.Singleton=1]="Singleton",C[C.ResolutionScoped=2]="ResolutionScoped",C[C.ContainerScoped=3]="ContainerScoped";var P=E,V=function(e,t){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},V(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function x(e,t){function n(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function N(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))}function D(e,t){var n,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(s=i.trys,(s=s.length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){i.label=o[1];break}if(6===o[0]&&i.label<s[1]){i.label=s[1],s=o;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(o);break}s[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function M(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,s,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return i}function F(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(U(arguments[t]));return e}var G="injectionTokens";function j(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],n=Reflect.getOwnMetadata(G,e)||{};return Object.keys(n).forEach((function(e){t[+e]=n[e]})),t}function H(e,t){return function(n,r,s){var o=Reflect.getOwnMetadata(G,n)||{};o[s]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(G,o,n)}}function B(e){return!!e.useClass}function W(e){return!!e.useFactory}var $=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,n=this,r=!1;return new Proxy({},this.createHandler((function(){return r||(t=e(n.wrap()),r=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(n){t[n]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t[0]=e();var s=Reflect[n];return s.apply(void 0,F(t))}})),t},e}();function z(e){return"string"==typeof e||"symbol"==typeof e}function q(e){return"object"==typeof e&&"token"in e&&"multiple"in e}function Q(e){return"object"==typeof e&&"token"in e&&"transform"in e}function K(e){return"function"==typeof e||e instanceof $}function Y(e){return!!e.useToken}function J(e){return null!=e.useValue}function Z(e){return B(e)||J(e)||Y(e)||W(e)}var X=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t}(X),te=function(){this.scopedResolutions=new Map};function ne(e,t,n){var r,s,o=U(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],i=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===o?null:o,t);return r="Cannot inject the dependency "+i+' of "'+e.name+'" constructor. Reason:',void 0===s&&(s="    "),F([r],n.message.split("\n").map((function(e){return s+e}))).join("\n")}var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t}(X),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),t}(X),oe=function(){this.preResolution=new re,this.postResolution=new se},ie=new Map,ae=new(function(){function e(e){this.parent=e,this._registry=new ee,this.interceptors=new oe,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,n){var r;if(void 0===n&&(n={lifecycle:P.Transient}),this.ensureNotDisposed(),Y(r=Z(t)?t:{useClass:t}))for(var s=[e],o=r;null!=o;){var i=o.useToken;if(s.includes(i))throw new Error("Token registration cycle detected! "+F(s,[i]).join(" -> "));s.push(i);var a=this._registry.get(i);o=a&&Y(a.provider)?a.provider:null}if((n.lifecycle===P.Singleton||n.lifecycle==P.ContainerScoped||n.lifecycle==P.ResolutionScoped)&&(J(r)||W(r)))throw new Error('Cannot use lifecycle "'+P[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:r,options:n}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),z(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),z(e)){if(z(t))return this.register(e,{useToken:t},{lifecycle:P.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:P.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=e;return t&&!z(t)&&(n=t),this.register(e,{useClass:n},{lifecycle:P.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new te),this.ensureNotDisposed();var n=this.getRegistration(e);if(!n&&z(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),n){var r=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,r,"Single"),r}if(K(e)){r=this.construct(e,t);return this.executePostResolutionInterceptor(e,r,"Single"),r}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var n,r;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var o=M(this.interceptors.preResolution.getAll(e)),i=o.next();!i.done;i=o.next()){var a=i.value;"Once"!=a.options.frequency&&s.push(a),a.callback(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(e,s)}},e.prototype.executePostResolutionInterceptor=function(e,t,n){var r,s;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var i=M(this.interceptors.postResolution.getAll(e)),a=i.next();!a.done;a=i.next()){var c=a.value;"Once"!=c.options.frequency&&o.push(c),c.callback(e,t,n)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(r)throw r.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===P.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var n,r=e.options.lifecycle===P.Singleton,s=e.options.lifecycle===P.ContainerScoped,o=r||s;return n=J(e.provider)?e.provider.useValue:Y(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):B(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):W(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===P.ResolutionScoped&&t.scopedResolutions.set(e,n),n},e.prototype.resolveAll=function(e,t){var n=this;void 0===t&&(t=new te),this.ensureNotDisposed();var r=this.getAllRegistrations(e);if(!r&&z(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),r){var s=r.map((function(e){return n.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,s,"All"),s}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var n=M(this._registry.entries()),r=n.next();!r.done;r=n.next()){var s=U(r.value,2),o=s[0],i=s[1];this._registry.setAll(o,i.filter((function(e){return!J(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,n;this.ensureNotDisposed();var r=new e(this);try{for(var s=M(this._registry.entries()),o=s.next();!o.done;o=s.next()){var i=U(o.value,2),a=i[0],c=i[1];c.some((function(e){return e.options.lifecycle===P.ContainerScoped}))&&r._registry.setAll(a,c.map((function(e){return e.options.lifecycle===P.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r},e.prototype.beforeResolution=function(e,t,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:n})},e.prototype.afterResolution=function(e,t,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:n})},e.prototype.dispose=function(){return N(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var n=t.dispose();n&&e.push(n)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var n=this;if(e instanceof $)return e.createProxy((function(e){return n.resolve(e,t)}));var r,s=function(){var r=ie.get(e);if(!r||0===r.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var s=r.map(n.resolveParams(t,e));return new(e.bind.apply(e,F([void 0],s)))}();return"function"!=typeof(r=s).dispose||r.dispose.length>0||this.disposables.add(s),s},e.prototype.resolveParams=function(e,t){var n=this;return function(r,s){var o,i,a;try{return q(r)?Q(r)?r.multiple?(o=n.resolve(r.transform)).transform.apply(o,F([n.resolveAll(r.token)],r.transformArgs)):(i=n.resolve(r.transform)).transform.apply(i,F([n.resolve(r.token,e)],r.transformArgs)):r.multiple?n.resolveAll(r.token):n.resolve(r.token,e):Q(r)?(a=n.resolve(r.transform,e)).transform.apply(a,F([n.resolve(r.token,e)],r.transformArgs)):n.resolve(r,e)}catch(e){throw new Error(ne(t,s,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}());var ce=function(e){return H(e)};var ue=function(){return function(e){ie.set(e,j(e))}};var le=function(){return function(e){ue()(e),ae.registerSingleton(e)}};var pe=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return H(e,{transformToken:t,args:n})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var he={};he=function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function t(n,r){function s(t,s,o){if("undefined"!=typeof document){"number"==typeof(o=e({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=t+"="+n.write(s,t)+i}}function o(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},s=0;s<t.length;s++){var o=t[s].split("="),i=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=n.read(i,a),e===a)break}catch(e){}}return e?r[e]:r}}return Object.create({set:s,get:o,remove:function(t,n){s(t,"",e({},n,{expires:-1}))},withAttributes:function(n){return t(this.converter,e({},this.attributes,n))},withConverter:function(n){return t(e({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(n)}})}return t({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();var de={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let fe;const ve=new Uint8Array(16);function ge(){if(!fe&&(fe="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fe(ve)}const ye=[];for(let e=0;e<256;++e)ye.push((e+256).toString(16).slice(1));function me(e,t=0){return(ye[e[t+0]]+ye[e[t+1]]+ye[e[t+2]]+ye[e[t+3]]+"-"+ye[e[t+4]]+ye[e[t+5]]+"-"+ye[e[t+6]]+ye[e[t+7]]+"-"+ye[e[t+8]]+ye[e[t+9]]+"-"+ye[e[t+10]]+ye[e[t+11]]+ye[e[t+12]]+ye[e[t+13]]+ye[e[t+14]]+ye[e[t+15]]).toLowerCase()}var be=function(e,t,n){if(de.randomUUID&&!t&&!e)return de.randomUUID();const r=(e=e||{}).random||(e.rng||ge)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return me(r)};let we=class{generate(){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-";let t="";for(;t.length<10;)t+=e[Math.random()*e.length|0];return t}};we=s([ue()],we);let _e=class{constructor(e){this.cookiesManager=e}getNextNumberFromCookie(e){const t=parseInt(this.cookiesManager.get(e));return Number.isNaN(t)?1:t+1}};_e=s([ue(),o(0,ce("Cookies"))],_e);let Se=class{static extract(e){const t=e.split(".");if(t.length<2)return e;let n=`.${t[t.length-2]}.${t[t.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(n)>=0&&(n=`.${t[t.length-3]}${n}`),n}};Se=s([ue()],Se);let Ee=class{constructor(e){this.window=e}get(e){return this.window.fandomContext.tracking[e]?.value}set(e,t){this.window.fandomContext&&this.window.fandomContext.tracking||(this.window.fandomContext={...this.window.fandomContext,tracking:{}}),this.window.fandomContext.tracking[e]=t.value}remove(e){try{delete this.window.fandomContext.tracking[e]}catch{}}};Ee=s([ue(),o(0,ce("window"))],Ee);let Ce=class{constructor(e){this.cookiesManager=e}get(e){return this.cookiesManager.get(e)}set(e,t){const{value:n,domain:r,expiresMS:s}=t,o=new Date((new Date).getTime()+s);this.cookiesManager.set(e,n.toString(),{domain:r,expires:o})}remove(e){this.cookiesManager.remove(e)}};Ce=s([ue(),o(0,ce("Cookies"))],Ce);const Ie=18e5;let Te=class{constructor(e,t,n,r,s){this.windowRepository=e,this.cookieRepository=t,this.uuid=n,this.beaconGenerator=r,this.pageViewNumberGenerator=s}set(e,t){this.windowRepository.set(e,t),this.cookieRepository.set(e,t)}remove(e){this.windowRepository.remove(e),this.cookieRepository.remove(e)}setup(e){const t=Se.extract(e),n={domain:t,expiresMS:15552e6,value:this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId")||this.beaconGenerator.generate()};this.windowRepository.set("beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const r=this.cookieRepository.get("sessionId"),s={domain:t,expiresMS:Ie,value:r||this.uuid()};this.set("sessionId",s),this.set("pvNumber",{domain:e,expiresMS:Ie,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:t,expiresMS:Ie,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};Te=s([ue(),o(0,ce(Ee)),o(1,ce(Ce)),o(2,ce("uuid")),o(3,ce(we)),o(4,ce(_e))],Te);var Ae=Te;let Le=class{resolve(e,t,n){e.geoRequiresConsent&&e.gdprConsent||e.geoRequiresSignal&&!e.ccpaSignal||!e.geoRequiresSignal&&!e.geoRequiresConsent?t():(e.geoRequiresSignal&&e.ccpaSignal||e.geoRequiresConsent&&!e.gdprConsent)&&n()}};Le=s([ue()],Le);class Oe{static get(e){const t=window.location.search.substring(1);return new URLSearchParams(t).get(e)}static stringify(e){const t=new URLSearchParams(e);return t.sort(),t.toString()}}class Re{transform(e,t){return e.setLoggerGroup(t)}}let ke=class{logGroup="Global";debugGroup=this.getDebugGroup()||"";groups=this.debugGroup.split(",");INIT_TIME=Date.now();setLoggerGroup(e){return this.logGroup=e,this}getDebugGroup(){return Oe.get("identity_debug")}getTimeDelta(){return((Date.now()-this.INIT_TIME)/1e3).toFixed(4)}info(...e){""!==this.debugGroup&&("1"!==this.debugGroup&&-1===this.groups.indexOf(this.logGroup)||console.info(`${this.getTimeDelta()}s\t\t ${this.logGroup}`,e))}error(...e){""!==this.debugGroup&&("1"!==this.debugGroup&&-1===this.groups.indexOf(this.logGroup)||console.error(`${this.getTimeDelta()}s\t\t ${this.logGroup}`,e))}};ke=s([ue()],ke);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Pe=function(){return Pe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Pe.apply(this,arguments)},Ve={channelId:"default",host:window,coordinatorHost:window.top},xe={connect:"connect",connected:"connected"},Ne="@wikia/post-quecast";function De(e){return e.channelId&&e.libId===Ne&&e.action&&function(e){return"string"==typeof e.type&&"number"==typeof e.timestamp}(e.action)}function Me(e){return!e.data.private}function Ue(e,t){return e.data.channelId===t}function Fe(e){return e.data.action}var Ge=function(){function e(){}return e.make=function(e){return function(e){var t;return e.host===e.coordinatorHost&&!!(null===(t=e.coordinatorHost[Ne])||void 0===t?void 0:t.callbackConnector)}(e)?e.coordinatorHost[Ne].callbackConnector:new He({senderHost:e.coordinatorHost,listenerHost:e.host})},e}(),je=function(){function e(e){this.coordinatorHost=e,this.callbacks=[]}return e.prototype.dispatch=function(e){var t=this;if(!De(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.callbacks.forEach((function(n){return n({data:e,source:t.coordinatorHost})}))},e.prototype.addListener=function(e){this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),He=function(){function e(e){this.options=e,this.map=new Map}return e.prototype.dispatch=function(e){if(!De(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.options.senderHost.postMessage(e,"*")},e.prototype.addListener=function(e){var t=function(t){var n;(n=t)&&n.source&&n.data&&De(n.data)&&e(t)};this.map.set(e,t),this.options.listenerHost.addEventListener("message",t)},e.prototype.removeListener=function(e){var t=this.map.get(e);this.options.listenerHost.removeEventListener("message",t),this.map.delete(e)},e}(),Be=function(){function e(e){this.callbacks=[],this.history=[],this.channelId=e.channelId,this.connector=Ge.make(e),this.setupActions(),this.setupConnection()}return e.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},e.prototype.getHistory=function(){var e=this,t=function(n){if(Ue(n,e.channelId)&&function(e){return!!e.data.private}(n)){var r=Fe(n);(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.some((function(t){return e.type===t}))})(r,xe.connected)&&(e.connector.removeListener(t),e.handleActions.apply(e,r.history))}};this.connector.addListener(t)},e.prototype.listenEvent=function(){var e=this;this.connector.addListener((function(t){if(Ue(t,e.channelId)&&Me(t)){var n=Fe(t);e.handleActions(n)}}))},e.prototype.handleActions=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=this.history).push.apply(e,n),n.forEach((function(e){return t.callbacks.forEach((function(t){return t(e)}))}))},e.prototype.setupConnection=function(){this.connector.dispatch({action:{type:xe.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:Ne})},e.prototype.addListener=function(e){this.history.forEach((function(t){return e(t)})),this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),We=function(){function e(e){void 0===e&&(e={});var t=Pe(Pe({},Ve),e);this.channelId=t.channelId,this.connector=Ge.make(t)}return e.prototype.dispatch=function(e){this.connector.dispatch({action:Pe(Pe({},e),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:Ne})},e}(),$e=function(){function e(e){void 0===e&&(e={});var t=Pe(Pe({},Ve),e);this.transmitter=new We(t),this.receiver=new Be(t)}return e.prototype.dispatch=function(e){this.transmitter.dispatch(e)},e.prototype.addListener=function(e){this.receiver.addListener(e)},e.prototype.removeListener=function(e){this.receiver.removeListener(e)},e}(),ze=function(){function e(e,t){this.channelId=e,this.connectors=new Map,this.history=[],this.connectors.set(t,t[Ne].callbackConnector)}return e.prototype.addConnection=function(e){this.ensureConnector(e).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:Ne})},e.prototype.createConnectedAction=function(){return{type:xe.connected,history:this.history,timestamp:Date.now()}},e.prototype.broadcast=function(e){var t=this;this.history.push(e),this.connectors.forEach((function(n){n.dispatch({action:e,channelId:t.channelId,libId:Ne})}))},e.prototype.ensureConnector=function(e){return this.connectors.has(e)||this.connectors.set(e,new He({senderHost:e,listenerHost:e})),this.connectors.get(e)},e}(),qe=function(){function e(e){this.coordinatorHost=e,this.channels=new Map,this.callbackConnector=new je(e),this.postMessageConnector=new He({senderHost:e,listenerHost:e})}return e.prototype.init=function(){var e=this,t=function(t){Me(t)||(e.handleConnect(t),e.handleBroadcast(t))};this.callbackConnector.addListener(t),this.postMessageConnector.addListener(t)},e.prototype.handleConnect=function(e){(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.some((function(t){return e.data.action.type===t}))})(e,xe.connect)&&this.ensureChannel(e.data.channelId).addConnection(e.source)},e.prototype.handleBroadcast=function(e){(function(e){return!Object.values(xe).some((function(t){return e.data.action.type===t}))})(e)&&this.ensureChannel(e.data.channelId).broadcast(e.data.action)},e.prototype.ensureChannel=function(e){return this.channels.has(e)||this.channels.set(e,new ze(e,this.coordinatorHost)),this.channels.get(e)},e}();function Qe(e){if(void 0===e&&(e=window),!e[Ne]){var t=new qe(e);t.init(),e[Ne]=t}}function Ke(e){return"function"==typeof e}function Ye(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Je=Ye((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Ze(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Xe=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var i=c(o),a=i.next();!a.done;a=i.next()){a.value.remove(this)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else o.remove(this);var p=this.initialTeardown;if(Ke(p))try{p()}catch(e){s=e instanceof Je?e.errors:[e]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=c(h),f=d.next();!f.done;f=d.next()){var v=f.value;try{nt(v)}catch(e){s=null!=s?s:[],e instanceof Je?s=l(l([],u(s)),u(e.errors)):s.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}if(s)throw new Je(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)nt(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ze(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ze(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),et=Xe.EMPTY;function tt(e){return e instanceof Xe||e&&"closed"in e&&Ke(e.remove)&&Ke(e.add)&&Ke(e.unsubscribe)}function nt(e){Ke(e)?e():e.unsubscribe()}var rt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},st={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=st.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,l([e,t],u(n))):setTimeout.apply(void 0,l([e,t],u(n)))},clearTimeout:function(e){var t=st.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function ot(e){st.setTimeout((function(){var t=rt.onUnhandledError;if(!t)throw e;t(e)}))}function it(){}var at=ut("C",void 0,void 0);function ct(e){return ut("N",e,void 0)}function ut(e,t,n){return{kind:e,value:t,error:n}}var lt=null;function pt(e){if(rt.useDeprecatedSynchronousErrorHandling){var t=!lt;if(t&&(lt={errorThrown:!1,error:null}),e(),t){var n=lt,r=n.errorThrown,s=n.error;if(lt=null,r)throw s}}else e()}var ht=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,tt(t)&&t.add(n)):n.destination=bt,n}return r(t,e),t.create=function(e,t,n){return new gt(e,t,n)},t.prototype.next=function(e){this.isStopped?mt(ct(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?mt(ut("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?mt(at,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Xe),dt=Function.prototype.bind;function ft(e,t){return dt.call(e,t)}var vt=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){yt(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){yt(e)}else yt(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){yt(e)}},e}(),gt=function(e){function t(t,n,r){var s,o,i=e.call(this)||this;Ke(t)||!t?s={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:i&&rt.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},s={next:t.next&&ft(t.next,o),error:t.error&&ft(t.error,o),complete:t.complete&&ft(t.complete,o)}):s=t;return i.destination=new vt(s),i}return r(t,e),t}(ht);function yt(e){var t;rt.useDeprecatedSynchronousErrorHandling?(t=e,rt.useDeprecatedSynchronousErrorHandling&&lt&&(lt.errorThrown=!0,lt.error=t)):ot(e)}function mt(e,t){var n=rt.onStoppedNotification;n&&st.setTimeout((function(){return n(e,t)}))}var bt={closed:!0,next:it,error:function(e){throw e},complete:it},wt="function"==typeof Symbol&&Symbol.observable||"@@observable";function _t(e){return e}function St(e){return 0===e.length?_t:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Et=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,s=this,o=(r=e)&&r instanceof ht||function(e){return e&&Ke(e.next)&&Ke(e.error)&&Ke(e.complete)}(r)&&tt(r)?e:new gt(e,t,n);return pt((function(){var e=s,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?s._subscribe(o):s._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Ct(t))((function(t,r){var s=new gt({next:function(t){try{e(t)}catch(e){r(e),s.unsubscribe()}},error:r,complete:t});n.subscribe(s)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[wt]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return St(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Ct(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Ct(e){var t;return null!==(t=null!=e?e:rt.Promise)&&void 0!==t?t:Promise}function It(e){return function(t){if(function(e){return Ke(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Tt(e,t,n,r,s){return new At(e,t,n,r,s)}var At=function(e){function t(t,n,r,s,o,i){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=i,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return r(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(ht);var Lt=Array.isArray;function Ot(e){return t=function(t){return function(e,t){return Lt(t)?e.apply(void 0,l([],u(t))):e(t)}(e,t)},It((function(e,r){var s=0;e.subscribe(Tt(r,(function(e){r.next(t.call(n,e,s++))})))}));var t,n}function Rt(e,t,n){return n?Rt(e,t).pipe(Ot(n)):new Et((function(n){var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)},s=e(r);return Ke(t)?function(){return t(r,s)}:void 0}))}var kt=Ye((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Pt=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r(t,e),t.prototype.lift=function(e){var t=new Vt(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new kt},t.prototype.next=function(e){var t=this;pt((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=c(t.currentObservers),o=s.next();!o.done;o=s.next()){o.value.next(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;pt((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;pt((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,s=n.isStopped,o=n.observers;return r||s?et:(this.currentObservers=null,o.push(e),new Xe((function(){t.currentObservers=null,Ze(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,s=t.isStopped;n?e.error(r):s&&e.complete()},t.prototype.asObservable=function(){var e=new Et;return e.source=this,e},t.create=function(e,t){return new Vt(e,t)},t}(Et),Vt=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return r(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:et},t}(Pt),xt={now:function(){return(xt.delegate||Date).now()},delegate:void 0},Nt=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=xt);var s=e.call(this)||this;return s._bufferSize=t,s._windowTime=n,s._timestampProvider=r,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=n===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,n),s}return r(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,s=n._buffer,o=n._infiniteTimeWindow,i=n._timestampProvider,a=n._windowTime;r||(s.push(t),!o&&s.push(i.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),s=0;s<r.length&&!e.closed;s+=n?1:2)e.next(r[s]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,s=e._infiniteTimeWindow,o=(s?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!s){for(var i=n.now(),a=0,c=1;c<r.length&&r[c]<=i;c+=2)a=c;a&&r.splice(0,a+1)}},t}(Pt);function Dt(e){return Ke(e[wt])}function Mt(e){return Symbol.asyncIterator&&Ke(null==e?void 0:e[Symbol.asyncIterator])}function Ut(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ft="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Gt(e){return Ke(null==e?void 0:e[Ft])}function jt(e){return Ke(null==e?void 0:e.getReader)}function Ht(e){if(e instanceof Et)return e;if(null!=e){if(Dt(e))return i=e,new Et((function(e){var t=i[wt]();if(Ke(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((o=e)&&"number"==typeof o.length&&"function"!=typeof o)return s=e,new Et((function(e){for(var t=0;t<s.length&&!e.closed;t++)e.next(s[t]);e.complete()}));if(Ke(null==(r=e)?void 0:r.then))return n=e,new Et((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,ot)}));if(Mt(e))return Bt(e);if(Gt(e))return t=e,new Et((function(e){var n,r;try{for(var s=c(t),o=s.next();!o.done;o=s.next()){var i=o.value;if(e.next(i),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()}));if(jt(e))return Bt(function(e){return h(this,arguments,(function(){var t,n,r;return a(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,p(t.read())];case 3:return n=s.sent(),r=n.value,n.done?[4,p(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,p(r)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,r,s,o,i;throw Ut(e)}function Bt(e){return new Et((function(t){(function(e,t){var n,r,s,o;return i(this,void 0,void 0,(function(){var i,c;return a(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),n=d(e),a.label=1;case 1:return[4,n.next()];case 2:if((r=a.sent()).done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=a.sent(),s={error:c},[3,11];case 6:return a.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Wt(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new Pt}:t,r=e.resetOnError,s=void 0===r||r,o=e.resetOnComplete,i=void 0===o||o,a=e.resetOnRefCountZero,c=void 0===a||a;return function(e){var t,r,o,a=0,u=!1,l=!1,p=function(){null==r||r.unsubscribe(),r=void 0},h=function(){p(),t=o=void 0,u=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return It((function(e,f){a++,l||u||p();var v=o=null!=o?o:n();f.add((function(){0!==--a||l||u||(r=$t(d,c))})),v.subscribe(f),!t&&a>0&&(t=new gt({next:function(e){return v.next(e)},error:function(e){l=!0,p(),r=$t(h,s,e),v.error(e)},complete:function(){u=!0,p(),r=$t(h,i),v.complete()}}),Ht(e).subscribe(t))}))(e)}}function $t(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var s=new gt({next:function(){s.unsubscribe(),e()}});return Ht(t.apply(void 0,l([],u(n)))).subscribe(s)}}else e()}function zt(e,t,n){var r,s,o,i,a=!1;return e&&"object"==typeof e?(r=e.bufferSize,i=void 0===r?1/0:r,s=e.windowTime,t=void 0===s?1/0:s,a=void 0!==(o=e.refCount)&&o,n=e.scheduler):i=null!=e?e:1/0,Wt({connector:function(){return new Nt(i,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}let qt=class{constructor(e){this.window=e;const{channelId:t,coordinatorName:n}=this.getSettings();Qe(),this.communicator=new $e({channelId:t||"default",coordinatorHost:e[n]||top}),this.actions$=Rt((e=>this.communicator.addListener(e)),(e=>this.communicator.removeListener(e))).pipe(zt({refCount:!0}))}emit(e){this.communicator.dispatch(e)}on(e,t){this.actions$.pipe(this.ofType(e)).subscribe(t)}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}ofType(e){return t=>{return t.pipe((n=t=>t.category===e.category&&t.name===e.name,It((function(e,t){var s=0;e.subscribe(Tt(t,(function(e){return n.call(r,e,s++)&&t.next(e)})))}))));var n,r}}};qt=s([ue(),o(0,ce("window"))],qt);const Qt={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"}};class Kt{__global=!0;timestamp=Date.now();constructor(e,t){this.name=e.name,this.category=e.category||"[Identity]",this.type=`${this.category} ${e.name}`,Object.assign(this,t)}}const Yt=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf"];let Jt=class{loadScript(e,t){const n=document.createElement("script");n.src=e,Object.keys(t).map((e=>{n.setAttribute(e,t[e])})),document.body.appendChild(n)}};Jt=s([ue()],Jt);let Zt=class{constructor(e,t,n){this.cookiesManager=e,this.window=t,this.assetLoader=n,this.trackingGroup="C0004:1",this.consentGiven=new Promise((e=>this.resolveConsent=e));this.oneTrustModalClosed()&&this.consentsUpdated(),"us"===this.getLocation()&&(this.loadCCPASupportingLibrary(),this.consentsUpdated()),this.subscribe()}loadCCPASupportingLibrary(){this.assetLoader.loadScript("https://cdn.cookielaw.org/opt-out/otCCPAiab.js",{charSet:"UTF-8",type:"text/javascript","ccpa-opt-out-ids":"C0004","ccpa-opt-out-geo":"us","ccpa-opt-out-lspa":!0})}getLocation(){if(this.window.OneTrust&&this.window.OneTrust.getGeolocationData())return this.window.OneTrust.getGeolocationData().country?.toLowerCase();{const e=this.cookiesManager.get("Geo");if(e)return JSON.parse(e)?.country.toLowerCase()}}oneTrustModalClosed(){return!!this.cookiesManager.get("OptanonAlertBoxClosed")}subscribe(){let e=this.window.OptanonWrapper;this.window.OptanonWrapper=()=>{(this.oneTrustModalClosed()||"us"===this.getLocation())&&(this.consentsUpdated(),e?.())}}readTrackingConsents(){const e=this.cookiesManager.get("OptanonConsent"),t=e?.split("groups=").pop()?.split(";")[0]||"";return t.length&&e.includes("groups")?t.includes(this.trackingGroup):"us"===this.getLocation()}consentsUpdated(){const e=this.getLocation(),t="us"===e?!this.readTrackingConsents():this.readTrackingConsents();e&&this.resolveConsent({gdprConsent:!Yt.includes(e)||t,geoRequiresConsent:Yt.includes(e),geoRequiresSignal:"us"===e,ccpaSignal:"us"===e&&t})}};Zt=s([le(),o(0,ce("Cookies")),o(1,ce("window")),o(2,ce(Jt))],Zt);let Xt=class{constructor(e){this.window=e,this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.installUspApi(),this.consentGiven=new Promise((e=>this.resolveConsent=e)),this.readTrackingConsents(),this.subscribe()}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener()}consentsUpdated(e){this.resolveConsent({gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!e.startsWith(this.CCPA_TRACKING_ALLOWED)})}uspApiMessage(e,t,n){"ping"===e?n({uspapiLoaded:!1},!0):"getQueue"===e?n(this.queue,!0):this.queue.push([e,t,n])}addLocatorFrame(){const e="__uspapi";if(this.window.frames[e])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const t=document.createElement("iframe");t.name=e,t.style.display="none",document.body.appendChild(t)}addUspMessageListener(){this.window.addEventListener("message",(e=>{const t=this.convertUspMessageData(e);t&&this.uspMessageHandler(t,e)}),!1)}convertUspMessageData(e){try{return("string"==typeof e.data?JSON.parse(e.data):e.data).__uspapiCall}catch(e){}}uspMessageHandler(e,t){this.window.__uspapi(e.command,e.version,((n,r)=>{const s={__uspapiReturn:{returnValue:n,success:r,callId:e.callId}};t.source.postMessage(s,"*")}))}subscribe(){this.window.__uspapi&&this.window.__uspapi("addEventListener",this.USP_API_VERSION,this.consentsUpdated.bind(this))}readTrackingConsents(){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,this.consentsUpdated.bind(this))}};var en,tn,nn,rn,sn,on,an,cn,un,ln,pn,hn,dn,fn,vn,gn;Xt=s([le(),o(0,ce("window"))],Xt),(tn=en||(en={})).PING="ping",tn.GET_TC_DATA="getTCData",tn.GET_IN_APP_TC_DATA="getInAppTCData",tn.GET_VENDOR_LIST="getVendorList",tn.ADD_EVENT_LISTENER="addEventListener",tn.REMOVE_EVENT_LISTENER="removeEventListener",(rn=nn||(nn={})).STUB="stub",rn.LOADING="loading",rn.LOADED="loaded",rn.ERROR="error",(on=sn||(sn={})).VISIBLE="visible",on.HIDDEN="hidden",on.DISABLED="disabled",(cn=an||(an={})).TC_LOADED="tcloaded",cn.CMP_UI_SHOWN="cmpuishown",cn.USER_ACTION_COMPLETE="useractioncomplete";class yn{listenerId;callback;next;param;success=!0;constructor(e,t,n,r){Object.assign(this,{callback:e,listenerId:n,param:t,next:r});try{this.respond()}catch(e){this.invokeCallback(null)}}invokeCallback(e){const t=null!==e;"function"==typeof this.next?this.callback(this.next,e,t):this.callback(e,t)}}class mn extends yn{respond(){this.throwIfParamInvalid(),this.invokeCallback(new En(this.param,this.listenerId))}throwIfParamInvalid(){if(!(void 0===this.param||Array.isArray(this.param)&&this.param.every(Number.isInteger)))throw new Error("Invalid Parameter")}}class bn{eventQueue=new Map;queueNumber=0;add(e){return this.eventQueue.set(this.queueNumber,e),this.queueNumber++}remove(e){return this.eventQueue.delete(e)}exec(){this.eventQueue.forEach(((e,t)=>{new mn(e.callback,e.param,t,e.next)}))}clear(){this.queueNumber=0,this.eventQueue.clear()}get size(){return this.eventQueue.size}}class wn{static apiVersion="2";static tcfPolicyVersion;static eventQueue=new bn;static cmpStatus=nn.LOADING;static disabled=!1;static displayStatus=sn.HIDDEN;static cmpId;static cmpVersion;static eventStatus;static gdprApplies;static tcModel;static tcString;static reset(){delete this.cmpId,delete this.cmpVersion,delete this.eventStatus,delete this.gdprApplies,delete this.tcModel,delete this.tcString,delete this.tcfPolicyVersion,this.cmpStatus=nn.LOADING,this.disabled=!1,this.displayStatus=sn.HIDDEN,this.eventQueue.clear()}}class _n{cmpId=wn.cmpId;cmpVersion=wn.cmpVersion;gdprApplies=wn.gdprApplies;tcfPolicyVersion=wn.tcfPolicyVersion}class Sn extends _n{cmpStatus=nn.ERROR}class En extends _n{tcString;listenerId;eventStatus;cmpStatus;isServiceSpecific;useNonStandardStacks;publisherCC;purposeOneTreatment;outOfBand;purpose;vendor;specialFeatureOptins;publisher;constructor(e,t){if(super(),this.eventStatus=wn.eventStatus,this.cmpStatus=wn.cmpStatus,this.listenerId=t,wn.gdprApplies){const t=wn.tcModel;this.tcString=wn.tcString,this.isServiceSpecific=t.isServiceSpecific,this.useNonStandardStacks=t.useNonStandardStacks,this.purposeOneTreatment=t.purposeOneTreatment,this.publisherCC=t.publisherCountryCode,this.outOfBand={allowedVendors:this.createVectorField(t.vendorsAllowed,e),disclosedVendors:this.createVectorField(t.vendorsDisclosed,e)},this.purpose={consents:this.createVectorField(t.purposeConsents),legitimateInterests:this.createVectorField(t.purposeLegitimateInterests)},this.vendor={consents:this.createVectorField(t.vendorConsents,e),legitimateInterests:this.createVectorField(t.vendorLegitimateInterests,e)},this.specialFeatureOptins=this.createVectorField(t.specialFeatureOptins),this.publisher={consents:this.createVectorField(t.publisherConsents),legitimateInterests:this.createVectorField(t.publisherLegitimateInterests),customPurpose:{consents:this.createVectorField(t.publisherCustomConsents),legitimateInterests:this.createVectorField(t.publisherCustomLegitimateInterests)},restrictions:this.createRestrictions(t.publisherRestrictions)}}}createRestrictions(e){const t={};if(e.numRestrictions>0){const n=e.getMaxVendorId();for(let r=1;r<=n;r++){const n=r.toString();e.getRestrictions(r).forEach((e=>{const r=e.purposeId.toString();t[r]||(t[r]={}),t[r][n]=e.restrictionType}))}}return t}createVectorField(e,t){return t?t.reduce(((t,n)=>(t[String(n)]=e.has(Number(n)),t)),{}):[...e].reduce(((e,t)=>(e[t[0].toString(10)]=t[1],e)),{})}}class Cn extends En{constructor(e){super(e),delete this.outOfBand}createVectorField(e){return[...e].reduce(((e,t)=>e+=t[1]?"1":"0"),"")}createRestrictions(e){const t={};if(e.numRestrictions>0){const n=e.getMaxVendorId();e.getRestrictions().forEach((e=>{t[e.purposeId.toString()]="_".repeat(n)}));for(let r=0;r<n;r++){const n=r+1;e.getRestrictions(n).forEach((e=>{const n=e.restrictionType.toString(),s=e.purposeId.toString(),o=t[s].substr(0,r),i=t[s].substr(r+1);t[s]=o+n+i}))}}return t}}class In extends _n{cmpLoaded=!0;cmpStatus=wn.cmpStatus;displayStatus=wn.displayStatus;apiVersion=String(wn.apiVersion);gvlVersion;constructor(){super(),wn.tcModel&&wn.tcModel.vendorListVersion&&(this.gvlVersion=+wn.tcModel.vendorListVersion)}}class Tn extends yn{respond(){this.invokeCallback(new In)}}class An extends mn{respond(){this.throwIfParamInvalid(),this.invokeCallback(new Cn(this.param))}}class Ln extends Error{constructor(e){super(e),this.name="DecodingError"}}class On extends Error{constructor(e){super(e),this.name="EncodingError"}}class Rn extends Error{constructor(e){super(e),this.name="GVLError"}}class kn extends Error{constructor(e,t,n=""){super(`invalid value ${t} passed for ${e} ${n}`),this.name="TCModelError"}}class Pn{static DICT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static REVERSE_DICT=new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]]);static BASIS=6;static LCM=24;static encode(e){if(!/^[0-1]+$/.test(e))throw new On("Invalid bitField");const t=e.length%this.LCM;e+=t?"0".repeat(this.LCM-t):"";let n="";for(let t=0;t<e.length;t+=this.BASIS)n+=this.DICT[parseInt(e.substr(t,this.BASIS),2)];return n}static decode(e){if(!/^[A-Za-z0-9\-_]+$/.test(e))throw new Ln("Invalidly encoded Base64URL string");let t="";for(let n=0;n<e.length;n++){const r=this.REVERSE_DICT.get(e[n]).toString(2);t+="0".repeat(this.BASIS-r.length)+r}return t}}class Vn{clone(){const e=new this.constructor;return Object.keys(this).forEach((t=>{const n=this.deepClone(this[t]);void 0!==n&&(e[t]=n)})),e}deepClone(e){const t=typeof e;if("number"===t||"string"===t||"boolean"===t)return e;if(null!==e&&"object"===t){if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(void 0!==e[Symbol.iterator]){const t=[];for(const n of e)t.push(this.deepClone(n));return e instanceof Array?t:new e.constructor(t)}{const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=this.deepClone(e[n]));return t}}}}class xn extends Vn{root=null;isEmpty(){return!this.root}add(e){const t={value:e,left:null,right:null};let n;if(this.isEmpty())this.root=t;else for(n=this.root;;)if(e<n.value){if(null===n.left){n.left=t;break}n=n.left}else{if(!(e>n.value))break;if(null===n.right){n.right=t;break}n=n.right}}get(){const e=[];let t=this.root;for(;t;)if(t.left){let n=t.left;for(;n.right&&n.right!=t;)n=n.right;n.right==t?(n.right=null,e.push(t.value),t=t.right):(n.right=t,t=t.left)}else e.push(t.value),t=t.right;return e}contains(e){let t=!1,n=this.root;for(;n;){if(n.value===e){t=!0;break}e>n.value?n=n.right:e<n.value&&(n=n.left)}return t}min(e=this.root){let t;for(;e;)e.left?e=e.left:(t=e.value,e=null);return t}max(e=this.root){let t;for(;e;)e.right?e=e.right:(t=e.value,e=null);return t}remove(e,t=this.root){let n=null,r="left";for(;t;)if(e<t.value)n=t,t=t.left,r="left";else if(e>t.value)n=t,t=t.right,r="right";else{if(t.left||t.right)if(t.left)if(t.right){const e=this.min(t.right);this.remove(e,t.right),t.value=e}else n?n[r]=t.left:this.root=t.left;else n?n[r]=t.right:this.root=t.right;else n?n[r]=null:this.root=null;t=null}}}class Nn{static langSet=new Set(["BG","CA","CS","DA","DE","EL","EN","ES","ET","FI","FR","HR","HU","IT","JA","LT","LV","MT","NL","NO","PL","PT","RO","RU","SK","SL","SV","TR","ZH"]);has(e){return Nn.langSet.has(e)}forEach(e){Nn.langSet.forEach(e)}get size(){return Nn.langSet.size}}class Dn{static cmpId="cmpId";static cmpVersion="cmpVersion";static consentLanguage="consentLanguage";static consentScreen="consentScreen";static created="created";static supportOOB="supportOOB";static isServiceSpecific="isServiceSpecific";static lastUpdated="lastUpdated";static numCustomPurposes="numCustomPurposes";static policyVersion="policyVersion";static publisherCountryCode="publisherCountryCode";static publisherCustomConsents="publisherCustomConsents";static publisherCustomLegitimateInterests="publisherCustomLegitimateInterests";static publisherLegitimateInterests="publisherLegitimateInterests";static publisherConsents="publisherConsents";static publisherRestrictions="publisherRestrictions";static purposeConsents="purposeConsents";static purposeLegitimateInterests="purposeLegitimateInterests";static purposeOneTreatment="purposeOneTreatment";static specialFeatureOptins="specialFeatureOptins";static useNonStandardStacks="useNonStandardStacks";static vendorConsents="vendorConsents";static vendorLegitimateInterests="vendorLegitimateInterests";static vendorListVersion="vendorListVersion";static vendorsAllowed="vendorsAllowed";static vendorsDisclosed="vendorsDisclosed";static version="version"}(ln=un||(un={}))[ln.NOT_ALLOWED=0]="NOT_ALLOWED",ln[ln.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",ln[ln.REQUIRE_LI=2]="REQUIRE_LI";class Mn extends Vn{static hashSeparator="-";purposeId_;restrictionType;constructor(e,t){super(),void 0!==e&&(this.purposeId=e),void 0!==t&&(this.restrictionType=t)}static unHash(e){const t=e.split(this.hashSeparator),n=new Mn;if(2!==t.length)throw new kn("hash",e);return n.purposeId=parseInt(t[0],10),n.restrictionType=parseInt(t[1],10),n}get hash(){if(!this.isValid())throw new Error("cannot hash invalid PurposeRestriction");return`${this.purposeId}${Mn.hashSeparator}${this.restrictionType}`}get purposeId(){return this.purposeId_}set purposeId(e){this.purposeId_=e}isValid(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===un.NOT_ALLOWED||this.restrictionType===un.REQUIRE_CONSENT||this.restrictionType===un.REQUIRE_LI)}isSameAs(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType}}class Un extends Vn{bitLength=0;map=new Map;gvl_;has(e){return this.map.has(e)}isOkToHave(e,t,n){let r=!0;if(this.gvl?.vendors){const s=this.gvl.vendors[n];if(s)if(e===un.NOT_ALLOWED)r=s.legIntPurposes.includes(t)||s.purposes.includes(t);else if(s.flexiblePurposes.length)switch(e){case un.REQUIRE_CONSENT:r=s.flexiblePurposes.includes(t)&&s.legIntPurposes.includes(t);break;case un.REQUIRE_LI:r=s.flexiblePurposes.includes(t)&&s.purposes.includes(t)}else r=!1;else r=!1}return r}add(e,t){if(this.isOkToHave(t.restrictionType,t.purposeId,e)){const n=t.hash;this.has(n)||(this.map.set(n,new xn),this.bitLength=0),this.map.get(n).add(e)}}restrictPurposeToLegalBasis(e){const t=this.gvl.vendorIds,n=e.hash,r=function(){let e;for(e of t);return e}();for(let e=1;e<=r;e++)this.has(n)||(this.map.set(n,new xn),this.bitLength=0),this.map.get(n).add(e)}getVendors(e){let t=[];if(e){const n=e.hash;this.has(n)&&(t=this.map.get(n).get())}else{const e=new Set;this.map.forEach((t=>{t.get().forEach((t=>{e.add(t)}))})),t=Array.from(e)}return t}getRestrictionType(e,t){let n;return this.getRestrictions(e).forEach((e=>{e.purposeId===t&&(void 0===n||n>e.restrictionType)&&(n=e.restrictionType)})),n}vendorHasRestriction(e,t){let n=!1;const r=this.getRestrictions(e);for(let e=0;e<r.length&&!n;e++)n=t.isSameAs(r[e]);return n}getMaxVendorId(){let e=0;return this.map.forEach((t=>{e=Math.max(t.max(),e)})),e}getRestrictions(e){const t=[];return this.map.forEach(((n,r)=>{e?n.contains(e)&&t.push(Mn.unHash(r)):t.push(Mn.unHash(r))})),t}getPurposes(){const e=new Set;return this.map.forEach(((t,n)=>{e.add(Mn.unHash(n).purposeId)})),Array.from(e)}remove(e,t){const n=t.hash,r=this.map.get(n);r&&(r.remove(e),r.isEmpty()&&(this.map.delete(n),this.bitLength=0))}set gvl(e){this.gvl_||(this.gvl_=e,this.map.forEach(((e,t)=>{const n=Mn.unHash(t);e.get().forEach((t=>{this.isOkToHave(n.restrictionType,n.purposeId,t)||e.remove(t)}))})))}get gvl(){return this.gvl_}isEmpty(){return 0===this.map.size}get numRestrictions(){return this.map.size}}(hn=pn||(pn={})).COOKIE="cookie",hn.WEB="web",hn.APP="app",(fn=dn||(dn={})).CORE="core",fn.VENDORS_DISCLOSED="vendorsDisclosed",fn.VENDORS_ALLOWED="vendorsAllowed",fn.PUBLISHER_TC="publisherTC";class Fn{static ID_TO_KEY=[dn.CORE,dn.VENDORS_DISCLOSED,dn.VENDORS_ALLOWED,dn.PUBLISHER_TC];static KEY_TO_ID={[dn.CORE]:0,[dn.VENDORS_DISCLOSED]:1,[dn.VENDORS_ALLOWED]:2,[dn.PUBLISHER_TC]:3}}class Gn extends Vn{bitLength=0;maxId_=0;set_=new Set;*[Symbol.iterator](){for(let e=1;e<=this.maxId;e++)yield[e,this.has(e)]}values(){return this.set_.values()}get maxId(){return this.maxId_}has(e){return this.set_.has(e)}unset(e){Array.isArray(e)?e.forEach((e=>this.unset(e))):"object"==typeof e?this.unset(Object.keys(e).map((e=>Number(e)))):(this.set_.delete(Number(e)),this.bitLength=0,e===this.maxId&&(this.maxId_=0,this.set_.forEach((e=>{this.maxId_=Math.max(this.maxId,e)}))))}isIntMap(e){let t="object"==typeof e;return t=t&&Object.keys(e).every((t=>{let n=Number.isInteger(parseInt(t,10));return n=n&&this.isValidNumber(e[t].id),n=n&&void 0!==e[t].name,n})),t}isValidNumber(e){return parseInt(e,10)>0}isSet(e){let t=!1;return e instanceof Set&&(t=Array.from(e).every(this.isValidNumber)),t}set(e){if(Array.isArray(e))e.forEach((e=>this.set(e)));else if(this.isSet(e))this.set(Array.from(e));else if(this.isIntMap(e))this.set(Object.keys(e).map((e=>Number(e))));else{if(!this.isValidNumber(e))throw new kn("set()",e,"must be positive integer array, positive integer, Set<number>, or IntMap");this.set_.add(e),this.maxId_=Math.max(this.maxId,e),this.bitLength=0}}empty(){this.set_=new Set}forEach(e){for(let t=1;t<=this.maxId;t++)e(this.has(t),t)}get size(){return this.set_.size}setAll(e){this.set(e)}}class jn{static[Dn.cmpId]=12;static[Dn.cmpVersion]=12;static[Dn.consentLanguage]=12;static[Dn.consentScreen]=6;static[Dn.created]=36;static[Dn.isServiceSpecific]=1;static[Dn.lastUpdated]=36;static[Dn.policyVersion]=6;static[Dn.publisherCountryCode]=12;static[Dn.publisherLegitimateInterests]=24;static[Dn.publisherConsents]=24;static[Dn.purposeConsents]=24;static[Dn.purposeLegitimateInterests]=24;static[Dn.purposeOneTreatment]=1;static[Dn.specialFeatureOptins]=12;static[Dn.useNonStandardStacks]=1;static[Dn.vendorListVersion]=12;static[Dn.version]=6;static anyBoolean=1;static encodingType=1;static maxId=16;static numCustomPurposes=6;static numEntries=12;static numRestrictions=12;static purposeId=6;static restrictionType=2;static segmentType=3;static singleOrRange=1;static vendorId=16}class Hn{static encode(e){return String(Number(e))}static decode(e){return"1"===e}}class Bn{static encode(e,t){let n;if("string"==typeof e&&(e=parseInt(e,10)),n=e.toString(2),n.length>t||e<0)throw new On(`${e} too large to encode into ${t}`);return n.length<t&&(n="0".repeat(t-n.length)+n),n}static decode(e,t){if(t!==e.length)throw new Ln("invalid bit length");return parseInt(e,2)}}class Wn{static encode(e,t){return Bn.encode(Math.round(e.getTime()/100),t)}static decode(e,t){if(t!==e.length)throw new Ln("invalid bit length");const n=new Date;return n.setTime(100*Bn.decode(e,t)),n}}class $n{static encode(e,t){let n="";for(let r=1;r<=t;r++)n+=Hn.encode(e.has(r));return n}static decode(e,t){if(e.length!==t)throw new Ln("bitfield encoding length mismatch");const n=new Gn;for(let r=1;r<=t;r++)Hn.decode(e[r-1])&&n.set(r);return n.bitLength=e.length,n}}class zn{static encode(e,t){const n=(e=e.toUpperCase()).charCodeAt(0)-65,r=e.charCodeAt(1)-65;if(n<0||n>25||r<0||r>25)throw new On(`invalid language code: ${e}`);if(t%2==1)throw new On(`numBits must be even, ${t} is not valid`);return Bn.encode(n,t/=2)+Bn.encode(r,t)}static decode(e,t){let n;if(t!==e.length||e.length%2)throw new Ln("invalid bit length for language");{const t=65,r=e.length/2,s=Bn.decode(e.slice(0,r),r)+t,o=Bn.decode(e.slice(r),r)+t;n=String.fromCharCode(s)+String.fromCharCode(o)}return n}}class qn{static encode(e){let t=Bn.encode(e.numRestrictions,jn.numRestrictions);return e.isEmpty()||e.getRestrictions().forEach((n=>{t+=Bn.encode(n.purposeId,jn.purposeId),t+=Bn.encode(n.restrictionType,jn.restrictionType);const r=e.getVendors(n),s=r.length;let o=0,i=0,a="";for(let t=0;t<s;t++){const n=r[t];0===i&&(o++,i=n);const c=r[s-1],u=e.gvl.vendorIds,l=e=>{for(;++e<=c&&!u.has(e););return e};if(t===s-1||r[t+1]>l(n)){const e=!(n===i);a+=Hn.encode(e),a+=Bn.encode(i,jn.vendorId),e&&(a+=Bn.encode(n,jn.vendorId)),i=0}}t+=Bn.encode(o,jn.numEntries),t+=a})),t}static decode(e){let t=0;const n=new Un,r=Bn.decode(e.substr(t,jn.numRestrictions),jn.numRestrictions);t+=jn.numRestrictions;for(let s=0;s<r;s++){const r=Bn.decode(e.substr(t,jn.purposeId),jn.purposeId);t+=jn.purposeId;const s=Bn.decode(e.substr(t,jn.restrictionType),jn.restrictionType);t+=jn.restrictionType;const o=new Mn(r,s),i=Bn.decode(e.substr(t,jn.numEntries),jn.numEntries);t+=jn.numEntries;for(let r=0;r<i;r++){const r=Hn.decode(e.substr(t,jn.anyBoolean));t+=jn.anyBoolean;const s=Bn.decode(e.substr(t,jn.vendorId),jn.vendorId);if(t+=jn.vendorId,r){const r=Bn.decode(e.substr(t,jn.vendorId),jn.vendorId);if(t+=jn.vendorId,r<s)throw new Ln(`Invalid RangeEntry: endVendorId ${r} is less than ${s}`);for(let e=s;e<=r;e++)n.add(e,o)}else n.add(s,o)}}return n.bitLength=t,n}}(gn=vn||(vn={}))[gn.FIELD=0]="FIELD",gn[gn.RANGE=1]="RANGE";class Qn{static encode(e){const t=[];let n,r=[],s=Bn.encode(e.maxId,jn.maxId),o="";const i=jn.maxId+jn.encodingType,a=i+e.maxId,c=2*jn.vendorId+jn.singleOrRange+jn.numEntries;let u=i+jn.numEntries;return e.forEach(((s,i)=>{if(o+=Hn.encode(s),n=e.maxId>c&&u<a,n&&s){e.has(i+1)?0===r.length&&(r.push(i),u+=jn.singleOrRange,u+=jn.vendorId):(r.push(i),u+=jn.vendorId,t.push(r),r=[])}})),n?(s+=String(vn.RANGE),s+=this.buildRangeEncoding(t)):(s+=String(vn.FIELD),s+=o),s}static decode(e,t){let n,r=0;const s=Bn.decode(e.substr(r,jn.maxId),jn.maxId);r+=jn.maxId;const o=Bn.decode(e.charAt(r),jn.encodingType);if(r+=jn.encodingType,o===vn.RANGE){if(n=new Gn,1===t){if("1"===e.substr(r,1))throw new Ln("Unable to decode default consent=1");r++}const s=Bn.decode(e.substr(r,jn.numEntries),jn.numEntries);r+=jn.numEntries;for(let t=0;t<s;t++){const t=Hn.decode(e.charAt(r));r+=jn.singleOrRange;const s=Bn.decode(e.substr(r,jn.vendorId),jn.vendorId);if(r+=jn.vendorId,t){const t=Bn.decode(e.substr(r,jn.vendorId),jn.vendorId);r+=jn.vendorId;for(let e=s;e<=t;e++)n.set(e)}else n.set(s)}}else{const t=e.substr(r,s);r+=s,n=$n.decode(t,s)}return n.bitLength=r,n}static buildRangeEncoding(e){const t=e.length;let n=Bn.encode(t,jn.numEntries);return e.forEach((e=>{const t=1===e.length;n+=Hn.encode(!t),n+=Bn.encode(e[0],jn.vendorId),t||(n+=Bn.encode(e[1],jn.vendorId))})),n}}function Kn(){return{[Dn.version]:Bn,[Dn.created]:Wn,[Dn.lastUpdated]:Wn,[Dn.cmpId]:Bn,[Dn.cmpVersion]:Bn,[Dn.consentScreen]:Bn,[Dn.consentLanguage]:zn,[Dn.vendorListVersion]:Bn,[Dn.policyVersion]:Bn,[Dn.isServiceSpecific]:Hn,[Dn.useNonStandardStacks]:Hn,[Dn.specialFeatureOptins]:$n,[Dn.purposeConsents]:$n,[Dn.purposeLegitimateInterests]:$n,[Dn.purposeOneTreatment]:Hn,[Dn.publisherCountryCode]:zn,[Dn.vendorConsents]:Qn,[Dn.vendorLegitimateInterests]:Qn,[Dn.publisherRestrictions]:qn,segmentType:Bn,[Dn.vendorsDisclosed]:Qn,[Dn.vendorsAllowed]:Qn,[Dn.publisherConsents]:$n,[Dn.publisherLegitimateInterests]:$n,[Dn.numCustomPurposes]:Bn,[Dn.publisherCustomConsents]:$n,[Dn.publisherCustomLegitimateInterests]:$n}}class Yn{1={[dn.CORE]:[Dn.version,Dn.created,Dn.lastUpdated,Dn.cmpId,Dn.cmpVersion,Dn.consentScreen,Dn.consentLanguage,Dn.vendorListVersion,Dn.purposeConsents,Dn.vendorConsents]};2={[dn.CORE]:[Dn.version,Dn.created,Dn.lastUpdated,Dn.cmpId,Dn.cmpVersion,Dn.consentScreen,Dn.consentLanguage,Dn.vendorListVersion,Dn.policyVersion,Dn.isServiceSpecific,Dn.useNonStandardStacks,Dn.specialFeatureOptins,Dn.purposeConsents,Dn.purposeLegitimateInterests,Dn.purposeOneTreatment,Dn.publisherCountryCode,Dn.vendorConsents,Dn.vendorLegitimateInterests,Dn.publisherRestrictions],[dn.PUBLISHER_TC]:[Dn.publisherConsents,Dn.publisherLegitimateInterests,Dn.numCustomPurposes,Dn.publisherCustomConsents,Dn.publisherCustomLegitimateInterests],[dn.VENDORS_ALLOWED]:[Dn.vendorsAllowed],[dn.VENDORS_DISCLOSED]:[Dn.vendorsDisclosed]}}class Jn{1=[dn.CORE];2=[dn.CORE];constructor(e,t){if(2===e.version)if(e.isServiceSpecific)this[2].push(dn.PUBLISHER_TC);else{const n=!(!t||!t.isForVendors);n&&!0!==e[Dn.supportOOB]||this[2].push(dn.VENDORS_DISCLOSED),n&&(e[Dn.supportOOB]&&e[Dn.vendorsAllowed].size>0&&this[2].push(dn.VENDORS_ALLOWED),this[2].push(dn.PUBLISHER_TC))}}}class Zn{static fieldSequence=new Yn;static encode(e,t){let n;try{n=this.fieldSequence[String(e.version)][t]}catch(n){throw new On(`Unable to encode version: ${e.version}, segment: ${t}`)}let r="";t!==dn.CORE&&(r=Bn.encode(Fn.KEY_TO_ID[t],jn.segmentType));const s=Kn();return n.forEach((n=>{const o=e[n],i=s[n];let a=jn[n];void 0===a&&this.isPublisherCustom(n)&&(a=Number(e[Dn.numCustomPurposes]));try{r+=i.encode(o,a)}catch(e){throw new On(`Error encoding ${t}->${n}: ${e.message}`)}})),Pn.encode(r)}static decode(e,t,n){const r=Pn.decode(e);let s=0;n===dn.CORE&&(t.version=Bn.decode(r.substr(s,jn[Dn.version]),jn[Dn.version])),n!==dn.CORE&&(s+=jn.segmentType);const o=this.fieldSequence[String(t.version)][n],i=Kn();return o.forEach((e=>{const n=i[e];let o=jn[e];if(void 0===o&&this.isPublisherCustom(e)&&(o=Number(t[Dn.numCustomPurposes])),0!==o){const i=r.substr(s,o);if(t[e]=n===Qn?n.decode(i,t.version):n.decode(i,o),Number.isInteger(o))s+=o;else{if(!Number.isInteger(t[e].bitLength))throw new Ln(e);s+=t[e].bitLength}}})),t}static isPublisherCustom(e){return 0===e.indexOf("publisherCustom")}}class Xn{static processor=[e=>e,(e,t)=>{e.publisherRestrictions.gvl=t,e.purposeLegitimateInterests.unset(1);const n=new Map;return n.set("legIntPurposes",e.vendorLegitimateInterests),n.set("purposes",e.vendorConsents),n.forEach(((n,r)=>{n.forEach(((s,o)=>{if(s){const s=t.vendors[o];if(!s||s.deletedDate)n.unset(o);else if(0===s[r].length)if("legIntPurposes"===r&&0===s.purposes.length&&0===s.legIntPurposes.length&&s.specialPurposes.length>0);else if(e.isServiceSpecific)if(0===s.flexiblePurposes.length)n.unset(o);else{const t=e.publisherRestrictions.getRestrictions(o);let s=!1;for(let e=0,n=t.length;e<n&&!s;e++)s=t[e].restrictionType===un.REQUIRE_CONSENT&&"purposes"===r||t[e].restrictionType===un.REQUIRE_LI&&"legIntPurposes"===r;s||n.unset(o)}else n.unset(o)}}))})),e.vendorsDisclosed.set(t.vendors),e}];static process(e,t){const n=e.gvl;if(!n)throw new On("Unable to encode TCModel without a GVL");if(!n.isReady)throw new On("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");(e=e.clone()).consentLanguage=n.language.toUpperCase(),t?.version>0&&t?.version<=this.processor.length?e.version=t.version:e.version=this.processor.length;const r=e.version-1;if(!this.processor[r])throw new On(`Invalid version: ${e.version}`);return this.processor[r](e,n)}}class er{static absCall(e,t,n,r){return new Promise(((s,o)=>{const i=new XMLHttpRequest;i.withCredentials=n,i.addEventListener("load",(()=>{if(i.readyState==XMLHttpRequest.DONE)if(i.status>=200&&i.status<300){let e=i.response;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}s(e)}else o(new Error(`HTTP Status: ${i.status} response type: ${i.responseType}`))})),i.addEventListener("error",(()=>{o(new Error("error"))})),i.addEventListener("abort",(()=>{o(new Error("aborted"))})),null===t?i.open("GET",e,!0):i.open("POST",e,!0),i.responseType="json",i.timeout=r,i.ontimeout=()=>{o(new Error("Timeout "+r+"ms "+e))},i.send(t)}))}static post(e,t,n=!1,r=0){return this.absCall(e,JSON.stringify(t),n,r)}static fetch(e,t=!1,n=0){return this.absCall(e,null,t,n)}}class tr extends Vn{static LANGUAGE_CACHE=new Map;static CACHE=new Map;static LATEST_CACHE_KEY=0;static DEFAULT_LANGUAGE="EN";static consentLanguages=new Nn;static baseUrl_;static set baseUrl(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new Rn("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this.baseUrl_=e}static get baseUrl(){return this.baseUrl_}static latestFilename="vendor-list.json";static versionedFilename="archives/vendor-list-v[VERSION].json";static languageFilename="purposes-[LANG].json";readyPromise;gvlSpecificationVersion;vendorListVersion;tcfPolicyVersion;lastUpdated;purposes;specialPurposes;features;specialFeatures;isReady_=!1;vendors_;vendorIds;fullVendorList;byPurposeVendorMap;bySpecialPurposeVendorMap;byFeatureVendorMap;bySpecialFeatureVendorMap;stacks;lang_;isLatest=!1;constructor(e){super();let t=tr.baseUrl;if(this.lang_=tr.DEFAULT_LANGUAGE,this.isVendorList(e))this.populate(e),this.readyPromise=Promise.resolve();else{if(!t)throw new Rn("must specify GVL.baseUrl before loading GVL json");if(e>0){const n=e;tr.CACHE.has(n)?(this.populate(tr.CACHE.get(n)),this.readyPromise=Promise.resolve()):(t+=tr.versionedFilename.replace("[VERSION]",String(n)),this.readyPromise=this.fetchJson(t))}else tr.CACHE.has(tr.LATEST_CACHE_KEY)?(this.populate(tr.CACHE.get(tr.LATEST_CACHE_KEY)),this.readyPromise=Promise.resolve()):(this.isLatest=!0,this.readyPromise=this.fetchJson(t+tr.latestFilename))}}static emptyLanguageCache(e){let t=!1;return void 0===e&&tr.LANGUAGE_CACHE.size>0?(tr.LANGUAGE_CACHE=new Map,t=!0):"string"==typeof e&&this.consentLanguages.has(e.toUpperCase())&&(tr.LANGUAGE_CACHE.delete(e.toUpperCase()),t=!0),t}static emptyCache(e){let t=!1;return Number.isInteger(e)&&e>=0?(tr.CACHE.delete(e),t=!0):void 0===e&&(tr.CACHE=new Map,t=!0),t}cacheLanguage(){tr.LANGUAGE_CACHE.has(this.lang_)||tr.LANGUAGE_CACHE.set(this.lang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks})}async fetchJson(e){try{this.populate(await er.fetch(e))}catch(e){throw new Rn(e.message)}}getJson(){return JSON.parse(JSON.stringify({gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,vendors:this.fullVendorList}))}async changeLanguage(e){const t=e.toUpperCase();if(!tr.consentLanguages.has(t))throw new Rn(`unsupported language ${e}`);if(t!==this.lang_)if(this.lang_=t,tr.LANGUAGE_CACHE.has(t)){const e=tr.LANGUAGE_CACHE.get(t);for(const t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}else{const t=tr.baseUrl+tr.languageFilename.replace("[LANG]",e);try{await this.fetchJson(t),this.cacheLanguage()}catch(e){throw new Rn("unable to load language: "+e.message)}}}get language(){return this.lang_}isVendorList(e){return void 0!==e&&void 0!==e.vendors}populate(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,"string"==typeof this.lastUpdated&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&tr.CACHE.set(tr.LATEST_CACHE_KEY,this.getJson()),tr.CACHE.has(this.vendorListVersion)||tr.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()}mapVendors(e){this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach((e=>{this.byPurposeVendorMap[e]={legInt:new Set,consent:new Set,flexible:new Set}})),Object.keys(this.specialPurposes).forEach((e=>{this.bySpecialPurposeVendorMap[e]=new Set})),Object.keys(this.features).forEach((e=>{this.byFeatureVendorMap[e]=new Set})),Object.keys(this.specialFeatures).forEach((e=>{this.bySpecialFeatureVendorMap[e]=new Set})),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map((e=>+e))),this.vendorIds=new Set(e),this.vendors_=e.reduce(((e,t)=>{const n=this.vendors_[String(t)];return n&&void 0===n.deletedDate&&(n.purposes.forEach((e=>{this.byPurposeVendorMap[String(e)].consent.add(t)})),n.specialPurposes.forEach((e=>{this.bySpecialPurposeVendorMap[String(e)].add(t)})),n.legIntPurposes.forEach((e=>{this.byPurposeVendorMap[String(e)].legInt.add(t)})),n.flexiblePurposes&&n.flexiblePurposes.forEach((e=>{this.byPurposeVendorMap[String(e)].flexible.add(t)})),n.features.forEach((e=>{this.byFeatureVendorMap[String(e)].add(t)})),n.specialFeatures.forEach((e=>{this.bySpecialFeatureVendorMap[String(e)].add(t)})),e[t]=n),e}),{})}getFilteredVendors(e,t,n,r){const s=e.charAt(0).toUpperCase()+e.slice(1);let o;const i={};return o="purpose"===e&&n?this["by"+s+"VendorMap"][String(t)][n]:this["by"+(r?"Special":"")+s+"VendorMap"][String(t)],o.forEach((e=>{i[String(e)]=this.vendors[String(e)]})),i}getVendorsWithConsentPurpose(e){return this.getFilteredVendors("purpose",e,"consent")}getVendorsWithLegIntPurpose(e){return this.getFilteredVendors("purpose",e,"legInt")}getVendorsWithFlexiblePurpose(e){return this.getFilteredVendors("purpose",e,"flexible")}getVendorsWithSpecialPurpose(e){return this.getFilteredVendors("purpose",e,void 0,!0)}getVendorsWithFeature(e){return this.getFilteredVendors("feature",e)}getVendorsWithSpecialFeature(e){return this.getFilteredVendors("feature",e,void 0,!0)}get vendors(){return this.vendors_}narrowVendorsTo(e){this.mapVendors(e)}get isReady(){return this.isReady_}clone(){const e=new tr(this.getJson());return this.lang_!==tr.DEFAULT_LANGUAGE&&e.changeLanguage(this.lang_),e}static isInstanceOf(e){return"object"==typeof e&&"function"==typeof e.narrowVendorsTo}}class nr extends Vn{static consentLanguages=tr.consentLanguages;isServiceSpecific_=!1;supportOOB_=!0;useNonStandardStacks_=!1;purposeOneTreatment_=!1;publisherCountryCode_="AA";version_=2;consentScreen_=0;policyVersion_=2;consentLanguage_="EN";cmpId_=0;cmpVersion_=0;vendorListVersion_=0;numCustomPurposes_=0;gvl_;created;lastUpdated;specialFeatureOptins=new Gn;purposeConsents=new Gn;purposeLegitimateInterests=new Gn;publisherConsents=new Gn;publisherLegitimateInterests=new Gn;publisherCustomConsents=new Gn;publisherCustomLegitimateInterests=new Gn;customPurposes;vendorConsents=new Gn;vendorLegitimateInterests=new Gn;vendorsDisclosed=new Gn;vendorsAllowed=new Gn;publisherRestrictions=new Un;constructor(e){super(),e&&(this.gvl=e),this.updated()}set gvl(e){tr.isInstanceOf(e)||(e=new tr(e)),this.gvl_=e,this.publisherRestrictions.gvl=e}get gvl(){return this.gvl_}set cmpId(e){if(e=Number(e),!(Number.isInteger(e)&&e>1))throw new kn("cmpId",e);this.cmpId_=e}get cmpId(){return this.cmpId_}set cmpVersion(e){if(e=Number(e),!(Number.isInteger(e)&&e>-1))throw new kn("cmpVersion",e);this.cmpVersion_=e}get cmpVersion(){return this.cmpVersion_}set consentScreen(e){if(e=Number(e),!(Number.isInteger(e)&&e>-1))throw new kn("consentScreen",e);this.consentScreen_=e}get consentScreen(){return this.consentScreen_}set consentLanguage(e){this.consentLanguage_=e}get consentLanguage(){return this.consentLanguage_}set publisherCountryCode(e){if(!/^([A-z]){2}$/.test(e))throw new kn("publisherCountryCode",e);this.publisherCountryCode_=e.toUpperCase()}get publisherCountryCode(){return this.publisherCountryCode_}set vendorListVersion(e){if((e=Number(e)>>0)<0)throw new kn("vendorListVersion",e);this.vendorListVersion_=e}get vendorListVersion(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_}set policyVersion(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new kn("policyVersion",e)}get policyVersion(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_}set version(e){this.version_=parseInt(e,10)}get version(){return this.version_}set isServiceSpecific(e){this.isServiceSpecific_=e}get isServiceSpecific(){return this.isServiceSpecific_}set useNonStandardStacks(e){this.useNonStandardStacks_=e}get useNonStandardStacks(){return this.useNonStandardStacks_}set supportOOB(e){this.supportOOB_=e}get supportOOB(){return this.supportOOB_}set purposeOneTreatment(e){this.purposeOneTreatment_=e}get purposeOneTreatment(){return this.purposeOneTreatment_}setAllVendorConsents(){this.vendorConsents.set(this.gvl.vendors)}unsetAllVendorConsents(){this.vendorConsents.empty()}setAllVendorsDisclosed(){this.vendorsDisclosed.set(this.gvl.vendors)}unsetAllVendorsDisclosed(){this.vendorsDisclosed.empty()}setAllVendorsAllowed(){this.vendorsAllowed.set(this.gvl.vendors)}unsetAllVendorsAllowed(){this.vendorsAllowed.empty()}setAllVendorLegitimateInterests(){this.vendorLegitimateInterests.set(this.gvl.vendors)}unsetAllVendorLegitimateInterests(){this.vendorLegitimateInterests.empty()}setAllPurposeConsents(){this.purposeConsents.set(this.gvl.purposes)}unsetAllPurposeConsents(){this.purposeConsents.empty()}setAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.set(this.gvl.purposes)}unsetAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.empty()}setAllSpecialFeatureOptins(){this.specialFeatureOptins.set(this.gvl.specialFeatures)}unsetAllSpecialFeatureOptins(){this.specialFeatureOptins.empty()}setAll(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()}unsetAll(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()}get numCustomPurposes(){let e=this.numCustomPurposes_;if("object"==typeof this.customPurposes){const t=Object.keys(this.customPurposes).sort(((e,t)=>Number(e)-Number(t)));e=parseInt(t.pop(),10)}return e}set numCustomPurposes(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new kn("numCustomPurposes",e)}updated(){const e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));this.created=t,this.lastUpdated=t}}class rr{static encode(e,t){let n,r="";return e=Xn.process(e,t),n=Array.isArray(t?.segments)?t.segments:new Jn(e,t)[""+e.version],n.forEach(((t,s)=>{let o="";s<n.length-1&&(o="."),r+=Zn.encode(e,t)+o})),r}static decode(e,t){const n=e.split("."),r=n.length;t||(t=new nr);for(let e=0;e<r;e++){const r=n[e],s=Pn.decode(r.charAt(0)).substr(0,jn.segmentType),o=Fn.ID_TO_KEY[Bn.decode(s,jn.segmentType).toString()];Zn.decode(r,t,o)}return t}}class sr extends yn{respond(){const e=wn.tcModel,t=e.vendorListVersion;let n;void 0===this.param&&(this.param=t),n=this.param===t&&e.gvl?e.gvl:new tr(this.param),n.readyPromise.then((()=>{this.invokeCallback(n.getJson())}))}}class or extends mn{respond(){this.listenerId=wn.eventQueue.add({callback:this.callback,param:this.param,next:this.next}),super.respond()}}class ir extends yn{respond(){this.invokeCallback(wn.eventQueue.remove(this.param))}}class ar{static[en.PING]=Tn;static[en.GET_TC_DATA]=mn;static[en.GET_IN_APP_TC_DATA]=An;static[en.GET_VENDOR_LIST]=sr;static[en.ADD_EVENT_LISTENER]=or;static[en.REMOVE_EVENT_LISTENER]=ir}class cr{static set_=new Set([0,2,void 0,null]);static has(e){return"string"==typeof e&&(e=Number(e)),this.set_.has(e)}}const ur="__tcfapi";class lr{callQueue;customCommands;constructor(e){if(e){let t=en.ADD_EVENT_LISTENER;if(e?.[t])throw new Error(`Built-In Custom Commmand for ${t} not allowed: Use ${en.GET_TC_DATA} instead`);if(t=en.REMOVE_EVENT_LISTENER,e?.[t])throw new Error(`Built-In Custom Commmand for ${t} not allowed`);e?.[en.GET_TC_DATA]&&(e[en.ADD_EVENT_LISTENER]=e[en.GET_TC_DATA],e[en.REMOVE_EVENT_LISTENER]=e[en.GET_TC_DATA]),this.customCommands=e}try{this.callQueue=window[ur]()||[]}catch(e){this.callQueue=[]}finally{window[ur]=this.apiCall.bind(this),this.purgeQueuedCalls()}}apiCall(e,t,n,...r){if("string"!=typeof e)n(null,!1);else if(cr.has(t)){if("function"!=typeof n)throw new Error("invalid callback function");wn.disabled?n(new Sn,!1):this.isCustomCommand(e)||this.isBuiltInCommand(e)?this.isCustomCommand(e)&&!this.isBuiltInCommand(e)?this.customCommands[e](n,...r):e===en.PING?this.isCustomCommand(e)?new ar[e](this.customCommands[e],r[0],null,n):new ar[e](n,r[0]):void 0===wn.tcModel?this.callQueue.push([e,t,n,...r]):this.isCustomCommand(e)&&this.isBuiltInCommand(e)?new ar[e](this.customCommands[e],r[0],null,n):new ar[e](n,r[0]):n(null,!1)}else n(null,!1)}purgeQueuedCalls(){const e=this.callQueue;this.callQueue=[],e.forEach((e=>{window[ur](...e)}))}isCustomCommand(e){return this.customCommands&&"function"==typeof this.customCommands[e]}isBuiltInCommand(e){return void 0!==ar[e]}}class pr{callResponder;isServiceSpecific;numUpdates=0;constructor(e,t,n=!1,r){this.throwIfInvalidInt(e,"cmpId",2),this.throwIfInvalidInt(t,"cmpVersion",0),wn.cmpId=e,wn.cmpVersion=t,wn.tcfPolicyVersion=2,this.isServiceSpecific=!!n,this.callResponder=new lr(r)}throwIfInvalidInt(e,t,n){if(!("number"==typeof e&&Number.isInteger(e)&&e>=n))throw new Error(`Invalid ${t}: ${e}`)}update(e,t=!1){if(wn.disabled)throw new Error("CmpApi Disabled");wn.cmpStatus=nn.LOADED,t?(wn.displayStatus=sn.VISIBLE,wn.eventStatus=an.CMP_UI_SHOWN):void 0===wn.tcModel?(wn.displayStatus=sn.DISABLED,wn.eventStatus=an.TC_LOADED):(wn.displayStatus=sn.HIDDEN,wn.eventStatus=an.USER_ACTION_COMPLETE),(wn.gdprApplies=null!==e)?(""===e?((wn.tcModel=new nr).cmpId=wn.cmpId,wn.tcModel.cmpVersion=wn.cmpVersion):wn.tcModel=rr.decode(e),wn.tcModel.isServiceSpecific=this.isServiceSpecific,wn.tcfPolicyVersion=Number(wn.tcModel.policyVersion),wn.tcString=e):wn.tcModel=null,0===this.numUpdates?this.callResponder.purgeQueuedCalls():wn.eventQueue.exec(),this.numUpdates++}disable(){wn.disabled=!0,wn.cmpStatus=nn.ERROR}}let hr=class{constructor(e){this.window=e,this.IAB_PURPOSES_COUNT=10,this.TCF_API_VERSION=2,this.CMP_VERSION=5,this.CMP_ID=141,this.initializeTcfApi(),this.consentGiven=new Promise((e=>this.resolveConsent=e)),this.readTrackingConsents(),this.subscribe()}initializeTcfApi(){void 0===this.window.__uspapi&&void 0===this.window.__tcfapi&&new pr(this.CMP_ID,this.CMP_VERSION,!0)}subscribe(){this.window.__tcfapi&&this.window.__tcfapi("addEventListener",this.TCF_API_VERSION,this.handleTcfSubscriptionResponse.bind(this))}handleTcfSubscriptionResponse(e){if("useractioncomplete"===e?.eventStatus||"tcloaded"===e?.eventStatus){const t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t),this.window.__tcfapi("removeEventListener",this.TCF_API_VERSION,(()=>{}),e.listenerId)}}readTrackingConsents(){this.window.__tcfapi&&this.window.__tcfapi("getTCData",this.TCF_API_VERSION,this.handleReadConsentsResponse.bind(this))}handleReadConsentsResponse(e){if("useractioncomplete"===e?.eventStatus||"tcloaded"===e?.eventStatus){const t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t)}}detectTcfTrackingConsent(e){return!!e?.purpose&&Object.keys(e.purpose.consents).map((t=>e.purpose.consents[t])).reduce(((e,t)=>t+e),0)===this.IAB_PURPOSES_COUNT}consentsUpdated(e){this.resolveConsent({gdprConsent:e,geoRequiresConsent:!0,geoRequiresSignal:!1,ccpaSignal:!1})}};hr=s([le(),o(0,ce("window"))],hr);let dr=class{constructor(e,t,n){this.window=e,this.logger=t,this.cookiesManager=n}getLocation(){if(this.window.OneTrust&&this.window.OneTrust.getGeolocationData())return this.window.OneTrust.getGeolocationData().country?.toLowerCase();{const e=this.cookiesManager.get("Geo");if(e)return JSON.parse(e)?.country.toLowerCase()}}get(){"us"===this.getLocation()?(this.consentProvider=ae.resolve(Xt),this.logger.info("__uspapi installed")):Yt.includes(this.getLocation())?(this.consentProvider=ae.resolve(hr),this.logger.info("__tcfapi installed")):this.logger.info("Consent query not found!");const e=ae.resolve(Zt);this.logger.info("OneTrust installed");const t=[e.consentGiven];return this.consentProvider&&t.push(this.consentProvider.consentGiven),Promise.race(t)}};dr=s([le(),o(0,ce("window")),o(1,pe(ke,Re,"OptInService")),o(2,ce("Cookies"))],dr);let fr,vr=class{constructor(e,t,n,r){this.communicationService=e,this.window=t,this.logger=r,this.consentProvider=n.get(),this.consentProvider?.then((e=>{this.logger.info("Sending consents: ",e),this.sendConsentsToAdEngine(e),this.sendConsentsToBidBarrel(e),this.logger.info("Consent given")}))}sendConsentsToAdEngine(e){this.communicationService.emit(new Kt(Qt.CONSENT_READY,e))}sendConsentsToBidBarrel(e){e&&(this.window.postMessage("cbs.otfired"),this.window.postMessage("cbs.otready"))}};vr=s([le(),o(0,ce(qt)),o(1,ce("window")),o(2,ce(dr)),o(3,pe(ke,Re,"OptInService"))],vr),(fr||(fr={})).GET="GET";let gr=class{async get(e){return fetch(e,{method:"GET",mode:"cors"})}};gr=s([ue()],gr);let yr,mr=class{constructor(e,t){this.logger=e,this.httpClient=t,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/identityinfo"}send(e){this.sendEvent(e,this.dataWarehouseUrl)}sendEvent(e,t){const n={...e,...this.getTimeBasedParams()},r=this.buildDataWarehouseUrl(n,t);r&&this.httpClient.get(r)}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t)return void this.logger.error("Error building DWH tracking URL");const n=new URLSearchParams(e);return n.sort(),`${t}?${n.toString()}`}};var br;mr=s([ue(),o(0,pe(ke,Re,"DataWarehouseService")),o(1,ce(gr))],mr),(br=yr||(yr={}))[br.identity=0]="identity";let wr=class{constructor(e,t){this.logger=e,this.identityEventSender=t}track(e,t){if(e===yr.identity)this.identityEventSender.send(t);else this.logger.info("Invalid event type to track")}};wr=s([ue(),o(0,pe(ke,Re,"DataWarehouseService")),o(1,ce(mr))],wr);let _r=class{constructor(e,t,n){this.dataWarehouse=e,this.window=t,this.logger=n}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const e=this.extractHEMs();Object.keys(e).forEach((t=>{e[t]&&this.dataWarehouse.track(yr.identity,{partner_name:"MediaWiki-"+t,partner_identity_id:e[t]})}))}isEnabled(){return this.window.ads?.context?.opts?.userEmailHashes&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const e=this.window.ads.context.opts.userEmailHashes;return{md5:e[0],sha1:e[1],sha256:e[2]}}};_r=s([ue(),o(0,ce(wr)),o(1,ce("window")),o(2,pe(ke,Re,"HemTracking"))],_r),ae.register("Cookies",{useValue:e(he)}),ae.register("uuid",{useValue:be}),ae.register("window",{useValue:window});let Sr=class{constructor(e,t,n,r,s,o,i){this.communicationService=e,this.optInService=t,this.hemTrackingService=n,this.trackingContextSetupService=r,this.consentResolver=s,this.window=o,this.logger=i,this.logger.info("Starting identity engine");const a=this.window.location.hostname;e.on(Qt.CONSENT_READY,(e=>s.resolve(e,(()=>{r.setup(a),this.hemTrackingService.activateTracking()}),(()=>r.clear()))))}};Sr=s([le(),o(0,ce(qt)),o(1,ce(vr)),o(2,ce(_r)),o(3,ce(Ae)),o(4,ce(Le)),o(5,ce("window")),o(6,pe(ke,Re,"IdentityEngine"))],Sr),ae.resolve(Sr)})();
//# sourceMappingURL=index.js.map
